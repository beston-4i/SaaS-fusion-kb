# HR Report Templates

**Purpose:** Ready-to-use SQL skeletons for HR reporting.

---

## 1. Active Headcount Report
*List all active employees with their current assignment details.*

```sql
/*
TITLE: HR Active Headcount
PURPOSE: List all currently active employees
*/

WITH
-- 1. Parameters
PARAMS AS (SELECT TRUNC(:P_EFF_DATE) AS EFF_DATE FROM DUAL),

-- 2. Repositories
WORKER_DATA AS (
    SELECT /*+ qb_name(WORKER) MATERIALIZE */
           PAPF.PERSON_ID, PAPF.PERSON_NUMBER, PNAME.FULL_NAME
    FROM   PER_ALL_PEOPLE_F PAPF, PER_PERSON_NAMES_F PNAME, PARAMS P
    WHERE  P.EFF_DATE BETWEEN PAPF.EFFECTIVE_START_DATE AND PAPF.EFFECTIVE_END_DATE
      AND  P.EFF_DATE BETWEEN PNAME.EFFECTIVE_START_DATE AND PNAME.EFFECTIVE_END_DATE
      AND  PNAME.NAME_TYPE = 'GLOBAL'
      AND  PAPF.PERSON_ID = PNAME.PERSON_ID
),

ASG_DATA AS (
    SELECT /*+ qb_name(ASG) MATERIALIZE */
           PAAM.PERSON_ID, HAOU.NAME AS DEPT_NAME, PAAM.ASSIGNMENT_NUMBER
    FROM   PER_ALL_ASSIGNMENTS_M PAAM
          ,HR_ALL_ORGANIZATION_UNITS_F HAOU
          ,PARAMS P
    WHERE  P.EFF_DATE BETWEEN PAAM.EFFECTIVE_START_DATE AND PAAM.EFFECTIVE_END_DATE
      AND  P.EFF_DATE BETWEEN HAOU.EFFECTIVE_START_DATE AND HAOU.EFFECTIVE_END_DATE
      AND  PAAM.ORGANIZATION_ID = HAOU.ORGANIZATION_ID
      AND  PAAM.ASSIGNMENT_STATUS_TYPE = 'ACTIVE'
      AND  PAAM.PRIMARY_FLAG = 'Y'
)

-- 3. Final Select
SELECT W.PERSON_NUMBER
      ,W.FULL_NAME
      ,A.DEPT_NAME
      ,A.ASSIGNMENT_NUMBER
FROM   WORKER_DATA W
      ,ASG_DATA A
WHERE  W.PERSON_ID = A.PERSON_ID
ORDER BY W.PERSON_NUMBER
```
